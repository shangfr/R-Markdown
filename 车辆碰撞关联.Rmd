##交通事故中车辆碰撞位置间的关联性分析

>------谨以此文献给自己考取驾照的坎坷经历：科二补考三次、科三补考三次

偶然间在网上看到了[法国数据公开平台](https://www.data.gouv.fr/en)，里面有各种各样的数据，其中就包括交通事故数据集，里面记载了每起交通事故的时间、地点和碰撞信息等。或许，每位司机一生中都难免经历几次行车中与其他机动车发生碰撞的事件，作为一位刚刚考取机动（ma）车(lu)驾(sha)驶(shou)证的人，我决定严肃认真仔细地研究下交通事故中车辆碰撞位置间的关联关系。So，顺便利用下法国的交通事故数据（想用国产的，可惜找不到）。

| Num_Acc| 	senc|	catv| 	occutc	|obs	| obsm	| choc|	manv| 	num_veh| 
| :--------: |:--------:| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| 201400000001| 	0	| 33| 	0	| 0	| 2| 	1| 	1| 	A01| 
| 201400000001| 0	| 7| 	0	| 0	| 0	| 6	| 15	| B02| 
| 201400000002| 0	| 7| 	0	| 1	| 0	| 7| 	13| 	A01| 

这个数据集共记录了法国2014年10多万起交通碰撞事故，标题是法语缩写，具体啥意思全靠猜，Num_Acc代表的应该是事故编号，num_veh代表的应该是车辆编号，choc下的号码代表的是车辆碰撞位置，下图可以详细说明这一点（其他列具体是啥意思，留给大家自己猜吧）。
![Alt text](./voiture_code_corpo.png)

每起交通事故中车辆碰撞的位置之间到底有没有关系？

- **首先**，从原始数据中提取**Num_Acc、num_veh、choc**三列数据；
- **然后**，将数据整理成碰撞位置关联矩阵，见下图：

 | 碰撞位置 | 无 |正面| 右前| 左前 |追尾 |右后 |左后 |右侧 |左侧 |多处|
 | :--------: |:--------:| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|无  |  1706  | 545  | 209  | 240   |110  |  50  |  73  | 178   |211   | 31 |
|正面 | 545| 5750| 2382 |3302 |4544| 1067| 1192| 2105| 2416 |  87|
|右前 | 209 |2382 | 506| 1843 | 337 | 168|  781  |217 | 920  | 30|
|左前 | 240 |3302 |1843 |2370 | 162 | 492 | 219 | 810 | 467 |  42|
|追尾 | 110 |4544 | 337 | 162 | 138  | 17 |   9  | 51 |  36 |  16|
|右后 |  50 |1067 | 168  |492  | 17  | 52 |  22  | 25 | 126 |   5|
|左后 |  73 |1192 | 781 | 219  |  9  | 22 |  82  | 98 |  62 |  15|
|右侧|  178 |2105|  217 | 810  | 51 |  25 |  98 | 136 | 918 |  15|
|左侧 | 211 |2416|  920 | 467  | 36  | 126 |  62 | 918 | 326  | 22|
|多处|   31  | 87|   30 |  42 |  16 |   5 |  15  | 15 |  22  | 12
|

- **最后**，将关系矩阵可视化，寻找关联关系。
```{r, echo=FALSE,fig.height=10,fig.width=10}
base = read.csv("E:/浏览器下载/vehicules_2014.csv")
T=table(base$Num_Acc)
idx=names(T)[which(T==2)]
nom=c("无","正面","右前","左前","追尾","右后","左后","右侧","左侧","多处")

 B=base[base$Num_Acc %in% idx,]  
 B=B[order(B$Num_Acc),]
 M=matrix(0,10,10)
 for(i in seq(1,nrow(B),by=2)){
   a=B$choc[i]+1
   b=B$choc[i+1]+1
   M[a,b]=M[a,b]+1
   M[b,a]=M[b,a]+1
 }
 rownames(M)=nom
 colnames(M)=nom

 coc=cor(M)
library(igraph)


g1=graph.adjacency(coc>0, mode="lower", weighted=NULL, diag=FALSE,
         add.colnames=NULL, add.rownames=NA)

 
 com = walktrap.community(g1, steps = 2) #子群划分
 V(g1)$sg = com$membership + 1
V(g1)$color = rainbow(max(V(g1)$sg))[V(g1)$sg]  #子群颜色
  V(g1)$size = 25 #子群大小
  V(g1)[com$membership == 1]$size = 35
 V(g1)[com$membership == 2]$size = 30
  V(g1)[com$membership == 3]$size = 25
  V(g1)[com$membership == 4]$size = 20

plot(g1) 

library(circlize)
chordDiagramFromMatrix(M,symmetric=TRUE)


```

通过上图可以看出，两车追尾的概率最大；其次是车辆左拐时导致左前方与正面驶来的车辆发生碰撞；其他的解读大家自己看吧，今天有点累，不写了。

### 反馈与建议
- 作者：[ShangFR](http://www.cnblogs.com/shangfr "博客主页")
- 邮箱：<shangfr@foxmail.com>
