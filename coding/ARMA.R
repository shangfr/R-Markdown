#如何用R做单变量的时间序列？
#加载时间序列程序包
library(tseries)
#使用该包自带的程序，是指航空乘客的分布
exp <- AirPassengers
#作这个时间序列的图,通过图作一个直观判断
par(mfrow=c(1,2))
ts.plot(exp)
#查看自相关图
acf(exp)
#查看偏相关图
pacf(exp)
#初步判断
#1、有趁势。2、可能有季节性。3、应该使用MA（）模型来拟合
#通过decompose 进行分解：随机、趋势、季节
x<-decompose(exp)
#作图查看
plot(x)
dev.off()
plot(x$seasonal)
#选择合适的模型拟合
#趋势通过差分来消除
#季节性因素，确定相应的period
exp.fit <- arima(express,order=c(0,1,1), seasonal=list(order=c(0,1,2), period=12))
arimafit<-auto.arima(air)
#对结果进行诊断
tsdiag(exp.fit)
#加载时间序列包
library(forecast)
#向前预测12期，默认情况下24期
#给出80%，95%置信度下的置信区间
exp.forecast <- forecast(exp.fit,4)
plot.forecast(exp.forecast)
a=c(144570.40,81779.50,142537.80,151483.90) #真实值
b=c(142744.2,121544.7,154304.6,156618.2) #预测值
(b-a)/a
 -0.01263191  0.48624900  0.08255214  0.03389337 #误差


express=structure(c(1119.7, 986.9, 1319.8, 1436.2, 1402.3, 1572.7, 1435.4, 
1592, 1678.2, 1425.8, 1575.2, 1695.1, 1277.7, 1410, 1666.9, 1688.5, 
1600.5, 1796.8, 1656.9, 1871.4, 1772.8, 1543.9, 1707, 1798.4, 
1549.8, 1369.4, 1822.8, 1903.7, 1826.6, 1988, 1884, 2161.2, 2289.2, 
1906.4, 2013.5, 2164.1, 1798.7, 1768.4, 2132.4, 2236.2, 2112.9, 
2373.3, 2655.1, 2637.4, 2601.5, 2159.3, 2213.2, 2315.8, 2235.1, 
1858.7, 2773.9, 2693.6, 2526.3, 2866.6, 2861, 3274.9, 3116.5, 
2643.7, 2795.9, 2984.4, 11227.7, 9137, 13350.8, 11220.4, 12187.4, 
12824.5, 12571.6, 13582.5, 13471.2, 13351.5, 13236.4, 15168.2, 
10971.8, 11781, 15292.7, 14593.4, 14829.1, 15714.1, 16273.1, 
16850.4, 17791.9, 14853.5, 17534.8, 19299, 17065.7, 11147.1, 
19083.3, 18193.8, 18661.1, 19438, 19308.2, 19710.6, 21535.3, 
20162.9, 23220, 26366.2, 25301.6, 17177.4, 28645.4, 28015, 29113.8, 
30078.4, 29599, 31235.6, 32462.6, 33414.7, 39393.8, 42873.8, 
27319.4, 35164.2, 41850.9, 40373.8, 48993.9, 45447.6, 46244.9, 
46561.8, 51345.3, 52421.3, 67126.6, 65698.4, 68917.7, 35473.1, 
67043.8, 66249.4, 74178.7, 72154.1, 74802.1, 75266.7, 83637.1, 
85303.5, 108703.4, 106945.3, 88950, 68886.2, 102528.2, 105417.5, 
111634.7, 112926.3, 111245.1, 114050.7, 122992, 128997.1, 164616.5, 
163681.1), .Tsp = c(2003, 2014.91666666667, 12), class = "ts")



#这里只是简单用到R自带的数据做了一个简单的演示过程，找个时间我再完整写一篇关于时间序列建模过程的文章，以及如何判断时间序列的P、Q、I等参数的确定。